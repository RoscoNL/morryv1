name: WordPress Theme CI

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    # Skip composer validation for now
    # - name: Validate composer.json and composer.lock
    #   run: |
    #     if [ -f "composer.json" ]; then
    #       composer validate --strict
    #     fi
    
    - name: Check PHP syntax
      run: |
        find . -name "*.php" -not -path "./vendor/*" -not -path "./.git/*" -print0 | xargs -0 -n1 php -l || true
    
    - name: Create deployment artifact
      run: |
        cd wp-content/themes
        if [ -d "norvault-theme" ]; then
          zip -r norvault-theme.zip norvault-theme/ -x "*.git*" "*node_modules*" "*.DS_Store"
        else
          echo "Theme directory not found"
        fi
        
    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        name: theme-package
        path: wp-content/themes/norvault-theme.zip
        if-no-files-found: ignore
        
    # Note: Voor automatische deployment naar 10Web:
    # 1. Gebruik 10Web's ingebouwde Git Deploy functie
    # 2. Of gebruik een FTP deploy action met je SFTP credentials
    # 3. Of gebruik de WordPress.org deployment action als je het daar publiceert